# ğŸ“¸ LÃ³gica de EvidÃªncias - Esclarecimento

## ğŸ¯ ENTENDIMENTO CORRETO

### âŒ ANTES (InterpretaÃ§Ã£o Incorreta)
"EvidÃªncias" era um checkbox separado, como mais um processo.

### âœ… AGORA (InterpretaÃ§Ã£o Correta)
**"Obrigar EvidÃªncias" significa:**  
"Exigir evidÃªncias FOTOGRÃFICAS de TODOS os processos obrigatÃ³rios"

---

## ğŸ“Š EXEMPLOS PRÃTICOS

### CenÃ¡rio 1: ANALISTA (SEM EvidÃªncias)
```
Cadastro no sistema:
  Cargo: ANALISTA
  âœ… SanitizaÃ§Ã£o
  âœ… DescaracterizaÃ§Ã£o
  âŒ PerfuraÃ§Ã£o de Disco
  âŒ Obrigar EvidÃªncias

Na tela de descarte:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Processos ObrigatÃ³rios              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â˜ SanitizaÃ§Ã£o                       â”‚
  â”‚ â˜ DescaracterizaÃ§Ã£o                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

UsuÃ¡rio marca:
  âœ… SanitizaÃ§Ã£o
  âœ… DescaracterizaÃ§Ã£o
  
Descarte permitido: SIM âœ…
```

### CenÃ¡rio 2: DIRETOR (COM EvidÃªncias)
```
Cadastro no sistema:
  Cargo: DIRETOR
  âœ… SanitizaÃ§Ã£o
  âœ… DescaracterizaÃ§Ã£o
  âœ… PerfuraÃ§Ã£o de Disco
  âœ… Obrigar EvidÃªncias â† IMPORTANTE!

Na tela de descarte:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Processos ObrigatÃ³rios              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ğŸ“¸ EvidÃªncias FotogrÃ¡ficas Obrig.   â”‚
  â”‚                                     â”‚
  â”‚ ğŸ“¸ SanitizaÃ§Ã£o        (0 fotos)     â”‚
  â”‚ ğŸ“¸ DescaracterizaÃ§Ã£o  (0 fotos)     â”‚
  â”‚ ğŸ“¸ PerfuraÃ§Ã£o Disco   (0 fotos)     â”‚
  â”‚                                     â”‚
  â”‚ [ğŸ“· Gerenciar EvidÃªncias]           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

UsuÃ¡rio clica em "Gerenciar EvidÃªncias":
  1. Modal abre
  2. Seleciona tipo: "SanitizaÃ§Ã£o"
  3. Anexa 2 fotos do processo
  4. Seleciona tipo: "DescaracterizaÃ§Ã£o"
  5. Anexa 1 foto
  6. Seleciona tipo: "PerfuraÃ§Ã£o Disco"
  7. Anexa 3 fotos

Resultado:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“¸ SanitizaÃ§Ã£o        (2 fotos) âœ…  â”‚
  â”‚ ğŸ“¸ DescaracterizaÃ§Ã£o  (1 foto)  âœ…  â”‚
  â”‚ ğŸ“¸ PerfuraÃ§Ã£o Disco   (3 fotos) âœ…  â”‚
  â”‚                                     â”‚
  â”‚ [ğŸ“· Gerenciar EvidÃªncias] (6)       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Descarte permitido: SIM âœ…
```

### CenÃ¡rio 3: CEO (COM EvidÃªncias mas INCOMPLETO)
```
Cadastro no sistema:
  Cargo: CEO
  âœ… SanitizaÃ§Ã£o
  âœ… DescaracterizaÃ§Ã£o
  âœ… PerfuraÃ§Ã£o de Disco
  âœ… Obrigar EvidÃªncias

UsuÃ¡rio anexa evidÃªncias:
  âœ… SanitizaÃ§Ã£o (2 fotos)
  âœ… DescaracterizaÃ§Ã£o (1 foto)
  âŒ PerfuraÃ§Ã£o Disco (0 fotos) â† FALTANDO!

Resultado:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“¸ SanitizaÃ§Ã£o        (2 fotos) âœ…  â”‚
  â”‚ ğŸ“¸ DescaracterizaÃ§Ã£o  (1 foto)  âœ…  â”‚
  â”‚ ğŸ“¸ PerfuraÃ§Ã£o Disco   (0 fotos) âŒ  â”‚
  â”‚                                     â”‚
  â”‚ [ğŸ“· Gerenciar EvidÃªncias] (3)       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tenta realizar descarte:
  âŒ BLOQUEADO
  âŒ Mensagem: "EvidÃªncia de PerfuraÃ§Ã£o de Disco (foto/arquivo)"
```

---

## ğŸ”„ FLUXO DE VALIDAÃ‡ÃƒO

### Backend - `EquipamentoNegocio.RealizarDescarte()`

```csharp
if (!dsc.ObrigarEvidencias)
{
    // ValidaÃ§Ã£o SIMPLES - apenas checkboxes
    if (dsc.ObrigarSanitizacao && !dsc.SanitizacaoExecutada)
        erro: "SanitizaÃ§Ã£o nÃ£o marcada";
}
else
{
    // ValidaÃ§Ã£o FOTOGRÃFICA - verificar evidÃªncias de CADA processo
    var evidencias = buscarEvidenciasDoEquipamento();
    
    if (dsc.ObrigarSanitizacao)
    {
        var temFotoSanitizacao = evidencias.Any(e => e.Tipoprocesso == "SANITIZACAO");
        if (!temFotoSanitizacao)
            erro: "EvidÃªncia de SanitizaÃ§Ã£o (foto/arquivo)";
    }
    
    if (dsc.ObrigarDescaracterizacao)
    {
        var temFotoDescaracterizacao = evidencias.Any(e => e.Tipoprocesso == "DESCARACTERIZACAO");
        if (!temFotoDescaracterizacao)
            erro: "EvidÃªncia de DescaracterizaÃ§Ã£o (foto/arquivo)";
    }
    
    if (dsc.ObrigarPerfuracaoDisco)
    {
        var temFotoPerfuracao = evidencias.Any(e => e.Tipoprocesso == "PERFURACAO_DISCO");
        if (!temFotoPerfuracao)
            erro: "EvidÃªncia de PerfuraÃ§Ã£o de Disco (foto/arquivo)";
    }
}
```

### Frontend - `descarte.component.ts.realizarDescarte()`

```typescript
if (!dsc.obrigarEvidencias)
{
    // ValidaÃ§Ã£o SIMPLES
    if (dsc.obrigarSanitizacao && !dsc.sanitizacaoExecutada)
        erro.push('SanitizaÃ§Ã£o');
}
else
{
    // ValidaÃ§Ã£o FOTOGRÃFICA
    if (dsc.obrigarSanitizacao && getCountEvidencias(dsc, 'SANITIZACAO') === 0)
        erro.push('EvidÃªncia de SanitizaÃ§Ã£o (foto/arquivo)');
    
    if (dsc.obrigarDescaracterizacao && getCountEvidencias(dsc, 'DESCARACTERIZACAO') === 0)
        erro.push('EvidÃªncia de DescaracterizaÃ§Ã£o (foto/arquivo)');
    
    if (dsc.obrigarPerfuracaoDisco && getCountEvidencias(dsc, 'PERFURACAO_DISCO') === 0)
        erro.push('EvidÃªncia de PerfuraÃ§Ã£o de Disco (foto/arquivo)');
}
```

---

## ğŸ’¡ INTERFACE DO USUÃRIO

### Quando NÃƒO exige evidÃªncias (ANALISTA)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processos ObrigatÃ³rios              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ SanitizaÃ§Ã£o                       â”‚
â”‚ â˜‘ DescaracterizaÃ§Ã£o                 â”‚
â”‚                                     â”‚
â”‚ â„¹ï¸ Cargos: ANALISTA                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**UsuÃ¡rio:** Apenas marca os checkboxes

### Quando EXIGE evidÃªncias (DIRETOR)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¸ EvidÃªncias FotogrÃ¡ficas Obrig.   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¸ SanitizaÃ§Ã£o        (2 fotos)     â”‚
â”‚ ğŸ“¸ DescaracterizaÃ§Ã£o  (1 foto)      â”‚
â”‚ ğŸ“¸ PerfuraÃ§Ã£o Disco   (3 fotos)     â”‚
â”‚                                     â”‚
â”‚ [ğŸ“· Gerenciar EvidÃªncias] (6)       â”‚
â”‚                                     â”‚
â”‚ â„¹ï¸ Cargos: DIRETOR                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**UsuÃ¡rio:** Clica em "Gerenciar EvidÃªncias" e anexa fotos

---

## ğŸ”’ TIPOS DE PROCESSOS NO MODAL

Quando o usuÃ¡rio abre o modal, pode selecionar:

| Tipo | CÃ³digo Backend | Quando Usar |
|------|----------------|-------------|
| SanitizaÃ§Ã£o | `SANITIZACAO` | Fotos do processo de sanitizaÃ§Ã£o |
| DescaracterizaÃ§Ã£o | `DESCARACTERIZACAO` | Fotos da descaracterizaÃ§Ã£o |
| PerfuraÃ§Ã£o de Disco | `PERFURACAO_DISCO` | Fotos da perfuraÃ§Ã£o fÃ­sica |
| EvidÃªncias Gerais | `EVIDENCIAS_GERAIS` | Outras evidÃªncias do descarte |

---

## âš ï¸ REGRAS IMPORTANTES

### 1. Checkbox "Obrigar EvidÃªncias" no Cadastro de Cargos
```
SE marcado: 
  â†’ UsuÃ¡rio DEVE anexar fotos de CADA processo marcado
  â†’ NÃƒO aparecem checkboxes simples
  â†’ Aparece botÃ£o "Gerenciar EvidÃªncias"

SE desmarcado:
  â†’ UsuÃ¡rio apenas marca checkboxes
  â†’ NÃƒO precisa anexar fotos
  â†’ ValidaÃ§Ã£o mais simples
```

### 2. ValidaÃ§Ã£o Ã© EspecÃ­fica por Processo
```
NÃ£o basta anexar "1 evidÃªncia geral"
Precisa anexar evidÃªncias de CADA TIPO:
  - Pelo menos 1 foto de SANITIZACAO
  - Pelo menos 1 foto de DESCARACTERIZACAO  
  - Pelo menos 1 foto de PERFURACAO_DISCO
```

### 3. Contador Mostra Total Geral
```
Badge (6) = Total de TODAS as evidÃªncias
Mas internamente valida se tem de CADA tipo
```

---

## ğŸ§ª TESTES RECOMENDADOS

### Teste 1: Cargo sem EvidÃªncias
```
1. Cadastrar cargo "ANALISTA":
   - SanitizaÃ§Ã£o: âœ…
   - DescaracterizaÃ§Ã£o: âœ…
   - EvidÃªncias: âŒ

2. Descarte:
   - Marcar checkboxes
   - Realizar descarte
   âœ… Sucesso!
```

### Teste 2: Cargo com EvidÃªncias Completo
```
1. Cadastrar cargo "DIRETOR":
   - SanitizaÃ§Ã£o: âœ…
   - DescaracterizaÃ§Ã£o: âœ…
   - PerfuraÃ§Ã£o: âœ…
   - EvidÃªncias: âœ…

2. Descarte:
   - Anexar 1 foto de SanitizaÃ§Ã£o
   - Anexar 1 foto de DescaracterizaÃ§Ã£o
   - Anexar 1 foto de PerfuraÃ§Ã£o
   - Realizar descarte
   âœ… Sucesso!
```

### Teste 3: Cargo com EvidÃªncias Incompleto
```
1. Cadastrar cargo "CEO":
   - SanitizaÃ§Ã£o: âœ…
   - DescaracterizaÃ§Ã£o: âœ…
   - PerfuraÃ§Ã£o: âœ…
   - EvidÃªncias: âœ…

2. Descarte:
   - Anexar 2 fotos de SanitizaÃ§Ã£o
   - Anexar 1 foto de DescaracterizaÃ§Ã£o
   - NÃƒO anexar fotos de PerfuraÃ§Ã£o
   - Tentar realizar descarte
   âŒ Bloqueado: "EvidÃªncia de PerfuraÃ§Ã£o de Disco (foto/arquivo)"
```

---

## âœ¨ RESUMO

**"Obrigar EvidÃªncias" = "Exigir comprovaÃ§Ã£o fotogrÃ¡fica de CADA processo"**

- Sem evidÃªncias â†’ Apenas confirmar verbalmente (checkbox)
- Com evidÃªncias â†’ Provar com fotos de cada etapa

**Desenvolvido com clareza! ğŸ‰**

---

**Data:** 03/10/2025  
**VersÃ£o:** Final

