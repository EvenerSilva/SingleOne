<!-- üìã CONTE√öDO PRINCIPAL -->
<div class="laudo-form-container">
  <form [formGroup]="form" (ngSubmit)="salvar()">
    <!-- üéØ HEADER DO FORMUL√ÅRIO -->
    <div class="form-header">
      <h2 class="form-title">Finaliza√ß√£o do Sinistro #{{laudo?.id}}</h2>
      <p class="form-subtitle">
        Complete as informa√ß√µes finais para encerrar o sinistro t√©cnico
      </p>
    </div>

    <!-- üìù FORMUL√ÅRIO PRINCIPAL -->
    <div class="info-grid">
      <!-- üìã SE√á√ÉO DO LAUDO FINAL -->
      <div class="info-section">
        <h3>Laudo T√©cnico Final</h3>
        <div class="form-group">
          <label class="form-label">Descri√ß√£o T√©cnica Completa *</label>
          <textarea 
            class="form-textarea" 
            formControlName="laudo" 
            placeholder="Descreva detalhadamente a an√°lise t√©cnica, conclus√µes e recomenda√ß√µes..."
            rows="6"

          ></textarea>
          <div class="form-error" *ngIf="form.get('laudo')?.invalid && form.get('laudo')?.touched">
            Laudo t√©cnico √© obrigat√≥rio
          </div>

        </div>
      </div>

      <!-- üí∞ SE√á√ÉO DE VALORES -->
      <div class="info-section">
        <h3>Informa√ß√µes Financeiras</h3>
        <div class="form-group">
          <label class="form-label">
            Valor da Manuten√ß√£o 
            <span *ngIf="form.get('temconserto')?.value" class="required-asterisk">*</span>
            <span *ngIf="!form.get('temconserto')?.value" class="optional-label">(Opcional)</span>
          </label>
          <div class="input-group">
            <span class="input-prefix">R$</span>
            <input 
              type="text" 
              class="form-input" 
              formControlName="valormanutencao" 
              [placeholder]="form.get('temconserto')?.value ? '0,00' : 'Deixe vazio se sem custo'"
              currencyMask 
              [options]="{ prefix: '', thousands: '.', decimal: ',' }"
              [disabled]="!form.get('temconserto')?.value"
            />
          </div>
          <div class="form-help" *ngIf="!form.get('temconserto')?.value">
            <i class="material-icons">info</i>
            Quando n√£o h√° conserto, o valor √© opcional
          </div>
          <div class="form-error" *ngIf="form.get('valormanutencao')?.invalid && form.get('valormanutencao')?.touched">
            <span *ngIf="form.get('valormanutencao')?.errors && form.get('valormanutencao')?.errors['required']">Valor da manuten√ß√£o √© obrigat√≥rio quando h√° conserto</span>
            <span *ngIf="form.get('valormanutencao')?.errors && form.get('valormanutencao')?.errors['valorInvalido']">Valor deve ser maior que zero</span>
          </div>

        </div>
      </div>

      <!-- ‚úÖ SE√á√ÉO DE AVALIA√á√ïES -->
      <div class="info-section">
        <h3>Avalia√ß√µes T√©cnicas</h3>
        <div class="evaluation-grid">
          <div class="evaluation-item">
            <label class="evaluation-label">
              <span class="label-text">Tem Conserto?</span>
              <span class="label-description">O equipamento pode ser reparado?</span>
            </label>
            <div class="toggle-container">
              <mat-slide-toggle 
                color="primary" 
                formControlName="temconserto" 
                class="modern-toggle"
              >
                <span class="toggle-text">{{form.get('temconserto')?.value ? 'Sim' : 'N√£o'}}</span>
              </mat-slide-toggle>
            </div>
          </div>

          <div class="evaluation-item">
            <label class="evaluation-label">
              <span class="label-text">Caracteriza Mau Uso?</span>
              <span class="label-description">O dano foi causado por uso inadequado?</span>
            </label>
            <div class="toggle-container">
              <mat-slide-toggle 
                color="warn" 
                formControlName="mauuso" 
                class="modern-toggle"
              >
                <span class="toggle-text">{{form.get('mauuso')?.value ? 'Sim' : 'N√£o'}}</span>
              </mat-slide-toggle>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- üéØ FOOTER DO FORMUL√ÅRIO -->
    <div class="form-footer">
      <button 
        type="button" 
        class="btn-cancel" 
        (click)="cancelar()"
      >
        <i class="cil-x"></i>
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn-primary" 
        [disabled]="form.invalid || salvando"
      >
        <i class="cil-check" *ngIf="!salvando"></i>
        <i class="cil-reload spinning" *ngIf="salvando"></i>
        {{salvando ? 'Salvando...' : 'Finalizar Sinistro'}}
      </button>
    </div>
  </form>
</div>
