<!-- üéØ HEADER MODERNO DOS PLANOS -->
<div class="planos-header">
  <div class="header-content">
    <div class="header-left">
      <div class="back-button" (click)="voltarParaTelecom()">
        <i class="cil-arrow-left"></i>
      </div>
      
      <div class="header-title">
        <div class="title-icon">
          <i class="cil-credit-card"></i>
        </div>
        
        <div class="title-text">
          <h1>Planos</h1>
          <p>Gest√£o de planos de telefonia</p>
        </div>
      </div>
    </div>
    
    <div class="header-right">
      <button class="action-btn" (click)="novo()">
        <i class="cil-plus"></i>
        <span>Novo Plano</span>
      </button>
    </div>
  </div>
</div>

<!-- üçû BREADCRUMB MODERNO -->
<div class="modern-breadcrumb">
  <div class="breadcrumb-container">
    <a class="breadcrumb-item" (click)="voltarParaTelecom()">
      <i class="cil-home"></i>
      <span>Telecom</span>
    </a>
    <i class="cil-chevron-right"></i>
    <a class="breadcrumb-item" (click)="navegarParaOperadoras()">
      <i class="cil-building"></i>
      <span>Operadoras</span>
    </a>
    <i class="cil-chevron-right"></i>
    <a class="breadcrumb-item" (click)="navegarParaContas()">
      <i class="cil-credit-card"></i>
      <span>Contas</span>
    </a>
    <i class="cil-chevron-right"></i>
    <span class="breadcrumb-item active">Planos</span>
    <i class="cil-chevron-right"></i>
    <a class="breadcrumb-item" (click)="navegarParaLinhasGeral()">
      <i class="cil-phone"></i>
      <span>Linhas</span>
    </a>
  </div>
</div>

<!-- üìã CONTE√öDO PRINCIPAL -->
<div class="planos-content">
  <!-- üîç SE√á√ÉO DE BUSCA -->
  <div class="search-section">
    <div class="search-box">
      <i class="cil-magnifying-glass search-icon"></i>
      <input 
        type="text" 
        placeholder="Buscar pelo nome da conta, operadora ou plano..." 
        [formControl]="consulta"
        class="form-control">
      <button 
        *ngIf="consulta.value" 
        class="clear-btn" 
        (click)="limparBusca()"
        type="button">
        <i class="cil-x"></i>
      </button>
    </div>
  </div>

  <!-- üìä TABELA MODERNA -->
  <div class="table-section">
    <table mat-table [dataSource]="dataSource" class="modern-table">
      <!-- Coluna Operadora -->
      <ng-container matColumnDef="operadora">
        <th mat-header-cell *matHeaderCellDef>Operadora</th>
        <td mat-cell *matCellDef="let row">{{ row.operadora }}</td>
      </ng-container>

      <!-- Coluna Conta -->
      <ng-container matColumnDef="contrato">
        <th mat-header-cell *matHeaderCellDef>Conta</th>
        <td mat-cell *matCellDef="let row">{{ row.contrato }}</td>
      </ng-container>

      <!-- Coluna Nome -->
      <ng-container matColumnDef="nome">
        <th mat-header-cell *matHeaderCellDef>Nome</th>
        <td mat-cell *matCellDef="let row">{{ row.nome }}</td>
      </ng-container>

      <!-- Coluna Valor -->
      <ng-container matColumnDef="valor">
        <th mat-header-cell *matHeaderCellDef>Valor</th>
        <td mat-cell *matCellDef="let row">{{ row.valor | currencyFormat }}</td>
      </ng-container>

      <!-- Coluna Totalizadores -->
      <ng-container matColumnDef="totalizadores">
        <th mat-header-cell *matHeaderCellDef>Totalizadores</th>
        <td mat-cell *matCellDef="let row">
          <div class="totalizadores-chips">
            <a class="chip total" 
               (click)="navegarParaLinhas(row.operadora, row.nome, 'todas')"
               matTooltip="Ver todas as linhas deste plano">
              {{ row.totalLinhas }} LINHAS
            </a>
            <a class="chip em-uso" 
               (click)="navegarParaLinhas(row.operadora, row.nome, 'em-uso')"
               matTooltip="Ver apenas linhas em uso">
              {{ row.totalLinhasEmUso }} EM USO
            </a>
            <a class="chip livres" 
               (click)="navegarParaLinhas(row.operadora, row.nome, 'livres')"
               matTooltip="Ver apenas linhas livres">
              {{ row.totalLinhasLivres }} LIVRES
            </a>
          </div>
        </td>
      </ng-container>

      <!-- Coluna Status -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef class="text-center">Status</th>
        <td mat-cell *matCellDef="let row" class="text-center">
          <div class="status-indicator" [class.ativo]="row.ativo" [class.inativo]="!row.ativo">
            <i [class]="row.ativo ? 'cil-check' : 'cil-ban'"></i>
            <span>{{ row.ativo ? 'Ativo' : 'Inativo' }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Coluna A√ß√µes -->
      <ng-container matColumnDef="acao">
        <th mat-header-cell *matHeaderCellDef class="text-center">A√ß√µes</th>
        <td mat-cell *matCellDef="let row" class="text-center">
          <div class="action-buttons">
            <button 
              class="action-btn edit-btn" 
              matTooltip="Editar"
              (click)="editar(row)">
              <i class="cil-pencil"></i>
            </button>
            
            <button 
              class="action-btn delete-btn" 
              matTooltip="Excluir"
              (click)="excluir(row)"
              *ngIf="row.totalLinhas == 0">
              <i class="cil-trash"></i>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="colunas"></tr>
      <tr mat-row *matRowDef="let row; columns: colunas"></tr>
    </table>
  </div>

  <!-- üìÑ PAGINA√á√ÉO -->
  <div class="pagination-container">
    <mat-paginator
      [pageSizeOptions]="[5, 10, 25, 100]"
      [pageSize]="10"
      showFirstLastButtons>
    </mat-paginator>
  </div>
</div>

<!-- üéØ FORMUL√ÅRIO DE PLANO (MODAL) -->
<div class="formulario-overlay" *ngIf="mostrarFormulario">
  <div class="formulario-container">
    <app-plano
      [plano]="planoEditando"
      [modo]="modoFormulario"
      (planoSalvo)="onPlanoSalvo($event)"
      (cancelado)="onCancelado()"
    ></app-plano>
  </div>
</div>
