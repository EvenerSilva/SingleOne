<!-- HEADER -->
<div class="configuracoes-header">
  <div class="header-content">
    <div class="header-left">
      <button class="btn-voltar" (click)="voltar()">
        <i class="cil-arrow-left"></i>
      </button>
      <div class="header-title">
        <div class="title-icon">
          <span style="font-size: 36px;">ü¶â</span>
        </div>
        <div class="title-text">
          <h1>Oni o S√°bio - Configura√ß√µes</h1>
          <p>Gerenciar funcionalidades do assistente inteligente</p>
        </div>
      </div>
    </div>
    <div class="header-right">
      <button 
        class="btn-salvar" 
        (click)="salvarConfiguracoes()"
        [disabled]="salvando">
        <i class="cil-save"></i>
        <span>{{ salvando ? 'Salvando...' : 'Salvar Configura√ß√µes' }}</span>
      </button>
    </div>
  </div>
</div>

<!-- BREADCRUMB -->
<nav class="modern-breadcrumb">
  <div class="breadcrumb-container">
    <a [routerLink]="['/dashboard']" class="breadcrumb-item">
      <i class="cil-home"></i>
      <span>Dashboard</span>
    </a>
    <i class="cil-chevron-right"></i>
    <a [routerLink]="['/configuracoes']" class="breadcrumb-item">
      <span>Configura√ß√µes</span>
    </a>
    <i class="cil-chevron-right"></i>
    <span class="breadcrumb-item active">Oni o S√°bio</span>
  </div>
</nav>

<!-- MENSAGENS -->
<div class="alerts-container" *ngIf="mensagemSucesso || mensagemErro">
  <div class="alert alert-success" *ngIf="mensagemSucesso">
    <i class="cil-check-circle"></i>
    {{ mensagemSucesso }}
  </div>
  <div class="alert alert-danger" *ngIf="mensagemErro">
    <i class="cil-x-circle"></i>
    {{ mensagemErro }}
  </div>
</div>

<!-- LOADING -->
<div class="loading-container" *ngIf="loading">
  <div class="spinner"></div>
  <p>Carregando configura√ß√µes...</p>
</div>

<!-- CONTE√öDO -->
<div class="tinone-config-content" *ngIf="!loading">
  
  <!-- AVISO IMPORTANTE -->
  <div class="info-box">
    <i class="cil-info"></i>
    <div>
      <strong>Importante:</strong> As altera√ß√µes nas configura√ß√µes do Oni ser√£o aplicadas ap√≥s salvar. 
      O bot√£o do assistente ü¶â aparecer√° no canto inferior direito da tela quando habilitado.
    </div>
  </div>

  <!-- CONFIGURA√á√ïES PRINCIPAIS -->
  <div class="config-section">
    <div class="section-header">
      <h2>‚öôÔ∏è Configura√ß√µes Principais</h2>
      <p>Ativar/desativar funcionalidades do assistente</p>
    </div>

    <div class="config-grid">
      <div 
        *ngFor="let config of configuracoes" 
        class="config-card"
        [class.disabled]="!config.ativo || isConfigDesabilitada(config.chave)"
        [class.master-disabled]="isConfigDesabilitada(config.chave)">
        
        <div class="config-card-header">
          <div class="config-icon">
            <i class="cil" [ngClass]="getIcon(config.chave)"></i>
          </div>
          <div class="config-info">
            <h3>
              {{ getConfigLabel(config.chave) }}
              <span class="badge-beta" *ngIf="isBeta(config.chave)">BETA</span>
              <span class="badge-locked" *ngIf="isConfigDesabilitada(config.chave)" title="Habilite o Oni primeiro">üîí</span>
            </h3>
            <p>{{ config.descricao }}</p>
          </div>
        </div>

        <div class="config-card-body">
          <!-- Toggle para booleanos -->
          <div *ngIf="isBoolean(config.chave)" class="toggle-container">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="config.valor === 'true'"
                (change)="toggleConfig(config)"
                [disabled]="!config.ativo || isConfigDesabilitada(config.chave)">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">
              {{ config.valor === 'true' ? 'Habilitado' : 'Desabilitado' }}
            </span>
          </div>

          <!-- Input para posi√ß√£o -->
          <div *ngIf="config.chave === 'TINONE_POSICAO'" class="input-container">
            <select 
              [(ngModel)]="config.valor" 
              class="form-select"
              [disabled]="!config.ativo || isConfigDesabilitada(config.chave)">
              <option value="bottom-right">Inferior Direito</option>
              <option value="bottom-left">Inferior Esquerdo</option>
            </select>
          </div>

          <!-- Input para cor -->
          <div *ngIf="config.chave === 'TINONE_COR_PRIMARIA'" class="input-container color-input">
            <input 
              type="color" 
              [(ngModel)]="config.valor"
              [disabled]="!config.ativo || isConfigDesabilitada(config.chave)">
            <input 
              type="text" 
              [(ngModel)]="config.valor"
              class="form-control"
              placeholder="#4a90e2"
              [disabled]="!config.ativo || isConfigDesabilitada(config.chave)">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- INFORMA√á√ïES ADICIONAIS -->
  <div class="info-section">
    <div class="info-card">
      <i class="cil-info"></i>
      <div>
        <h4>Sobre as Funcionalidades do Oni ü¶â</h4>
        <ul>
          <li><strong>Chat:</strong> Converse com o Oni para tirar d√∫vidas</li>
          <li><strong>Tooltips:</strong> Ajuda contextual inteligente nos campos dos formul√°rios</li>
          <li><strong>Guias:</strong> Oni te guia passo-a-passo pelos processos (em desenvolvimento)</li>
          <li><strong>Sugest√µes Proativas:</strong> Oni sugere a√ß√µes baseadas no contexto (beta)</li>
          <li><strong>IA/NLP:</strong> Respostas inteligentes com Intelig√™ncia Artificial (requer Ollama local)</li>
          <li><strong>Analytics:</strong> Ajuda o Oni a aprender e melhorar continuamente</li>
        </ul>
      </div>
    </div>

    <div class="warning-card" *ngIf="isOniDesabilitado()">
      <i class="cil-warning"></i>
      <div>
        <h4>ü¶â Oni Desabilitado - Interruptor Mestre</h4>
        <p>O assistente Oni o S√°bio est√° desabilitado. Este √© o <strong>interruptor mestre</strong> que controla todas as funcionalidades do Oni. Quando desabilitado, nenhuma funcionalidade (chat, tooltips, guias, etc.) estar√° dispon√≠vel. Habilite-o primeiro para poder ativar as funcionalidades espec√≠ficas!</p>
      </div>
    </div>
  </div>

</div>

